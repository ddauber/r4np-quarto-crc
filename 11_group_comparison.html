<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Are you interested in learning R, but intimidated by programming and statistical analysis? ‘R for Non-Programmers: A Guide for Social Scientists’ is the perfect resource for you. This book provides practical and efficient solutions to common challenges in empirical research in the Social Sciences, without assuming any prior knowledge or skills in programming or statistical analysis. Each chapter is dedicated to a specific task required to answer research questions and includes exercises and case studies based on real data. Whether you are a novice or experienced analyst, this book is a comprehensive entry to R programming that will help enhance your data analysis skills.">

<title>R for Non-Programmers: A Guide for Social Scientists - 11&nbsp; Comparing groups</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12_power_analysis.html" rel="next">
<link href="./10_correlations.html" rel="prev">
<link href="./r4np_icon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PF1VJZVM7C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PF1VJZVM7C');
</script>
<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11_group_comparison.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing groups</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Non-Programmers: A Guide for Social Scientists</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ddauber/r4np-quarto-crc" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_about_the_author.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About the author</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00_acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_before_you_get_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title"><code>Readme.</code> before you get started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_why_start_learning_a_programming_language.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Why learn a programming language as a non-programmer?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_setting_up_r_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Setting up <em>R</em> and RStudio</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_rstudio_interface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The RStudio Interface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><em>R</em> Basics: The very fundamentals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_starting_r_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Starting your <em>R</em> projects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_data_wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Wrangling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_descriptive_statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_sources_of_bias.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Sources of bias: Sampling, outliers, normality and other ‘conundrums’</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Correlations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_group_comparison.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing groups</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_power_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Power: You either have it or you don’t</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_regressions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Regression: Creating models to predict future observations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_mixed_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Mixed-methods research: Analysing qualitative data in <em>R</em></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_next_steps.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Where to go from here: The next steps in your <em>R</em> journey</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_epilogue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Epilogue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./99_appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-comparability-apples-vs-oranges" id="toc-sec-comparability-apples-vs-oranges" class="nav-link active" data-scroll-target="#sec-comparability-apples-vs-oranges"><span class="header-section-number">11.1</span> Comparability: Apples vs Oranges</a></li>
  <li><a href="#sec-comparing-two-groups" id="toc-sec-comparing-two-groups" class="nav-link" data-scroll-target="#sec-comparing-two-groups"><span class="header-section-number">11.2</span> Comparing two groups</a>
  <ul class="collapse">
  <li><a href="#sec-two-unpaired-groups" id="toc-sec-two-unpaired-groups" class="nav-link" data-scroll-target="#sec-two-unpaired-groups"><span class="header-section-number">11.2.1</span> Two unpaired groups</a></li>
  <li><a href="#sec-two-paired-groups" id="toc-sec-two-paired-groups" class="nav-link" data-scroll-target="#sec-two-paired-groups"><span class="header-section-number">11.2.2</span> Two paired groups</a></li>
  </ul></li>
  <li><a href="#sec-comparing-more-than-two-groups" id="toc-sec-comparing-more-than-two-groups" class="nav-link" data-scroll-target="#sec-comparing-more-than-two-groups"><span class="header-section-number">11.3</span> Comparing more than two groups</a>
  <ul class="collapse">
  <li><a href="#sec-multiple-unpaired-groups" id="toc-sec-multiple-unpaired-groups" class="nav-link" data-scroll-target="#sec-multiple-unpaired-groups"><span class="header-section-number">11.3.1</span> Multiple unpaired groups</a></li>
  <li><a href="#sec-multiple-paired-groups" id="toc-sec-multiple-paired-groups" class="nav-link" data-scroll-target="#sec-multiple-paired-groups"><span class="header-section-number">11.3.2</span> Multiple paired groups</a></li>
  </ul></li>
  <li><a href="#sec-chi-squared-test" id="toc-sec-chi-squared-test" class="nav-link" data-scroll-target="#sec-chi-squared-test"><span class="header-section-number">11.4</span> Comparing groups based on factors: Contingency tables</a>
  <ul class="collapse">
  <li><a href="#sec-unpaired-groups-categorical-variables" id="toc-sec-unpaired-groups-categorical-variables" class="nav-link" data-scroll-target="#sec-unpaired-groups-categorical-variables"><span class="header-section-number">11.4.1</span> Unpaired groups of categorical variables</a></li>
  <li><a href="#sec-paired-groups-categorical-variables" id="toc-sec-paired-groups-categorical-variables" class="nav-link" data-scroll-target="#sec-paired-groups-categorical-variables"><span class="header-section-number">11.4.2</span> Paired groups of categorical variables</a></li>
  <li><a href="#sec-a-final-remark-about-comparing-groups-based-on-categorical-data" id="toc-sec-a-final-remark-about-comparing-groups-based-on-categorical-data" class="nav-link" data-scroll-target="#sec-a-final-remark-about-comparing-groups-based-on-categorical-data"><span class="header-section-number">11.4.3</span> A final remark about comparing groups based on categorical data</a></li>
  </ul></li>
  <li><a href="#sec-reviewing-group-comparisons" id="toc-sec-reviewing-group-comparisons" class="nav-link" data-scroll-target="#sec-reviewing-group-comparisons"><span class="header-section-number">11.5</span> Reviewing group comparisons</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ddauber/r4np-quarto-crc/blob/main/11_group_comparison.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/ddauber/r4np-quarto-crc/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-comparing-groups" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Comparing groups</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Social Sciences is about the study of human beings and their interactions. As such, we frequently want to compare two or more groups of human beings, organisations, teams, countries, etc., with each other to see whether they are similar or different from each other. Sometimes we also want to track individuals over time and see how they may have changed in some way or other. In short, comparing groups is an essential technique to make inferences and helps us better understand the diversity surrounding us.</p>
<p>If we want to perform a group comparison, we have to consider which technique is most appropriate for our data. For example, some of it might be related to the type of data we have collected, and other aspects might be linked to the distribution of the data. More specifically, before we apply any statistical technique, we have to consider at least the following:</p>
<ul>
<li><p>missing data (see <a href="07_data_wrangling.html#sec-dealing-with-missing-data" class="quarto-xref"><span>Section 7.7</span></a>),</p></li>
<li><p>outliers (see <a href="09_sources_of_bias.html#sec-dealing-with-outliers" class="quarto-xref"><span>Section 9.6</span></a>), and</p></li>
<li><p>the assumptions made by analytical techniques about our data.</p></li>
</ul>
<p>While we covered missing data and outliers in previous chapters, we have yet to discuss assumptions. For group comparisons, there are three main questions we need to answer:</p>
<ul>
<li><p>Are the groups big enough to be compared, i.e.&nbsp;are they comparable?</p></li>
<li><p>Is my data parametric or non-parametric? (see <a href="09_sources_of_bias.html" class="quarto-xref"><span>Chapter 9</span></a>)</p></li>
<li><p>How many groups do I wish to compare?</p></li>
<li><p>Are these groups paired or unpaired?</p></li>
</ul>
<p>In the following, we will look at group comparisons for parametric and non-parametric data in each category and use the <code>wvs_nona</code> dataset, i.e.&nbsp;the <code>wvs</code> data frame after we performed imputation (see also <a href="07_data_wrangling.html#sec-replacing-removing-missing-data" class="quarto-xref"><span>Section 7.7.3</span></a>). Since we already covered how to test whether data is parametric or non-parametric, we will forgo this step out of pure convenience and remain succinct. We also ignore any potential outliers. Thus, parametric and non-parametric tests will be demonstrated with the same dataset and the same variables.</p>
<section id="sec-comparability-apples-vs-oranges" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sec-comparability-apples-vs-oranges"><span class="header-section-number">11.1</span> Comparability: Apples vs Oranges</h2>
<p>Before we can jump into group comparisons, we need to make ourselves aware of whether our groups can be compared in the first place. <em>‘Comparability’</em> should not be confused with ‘are the groups equal’. In many cases, we don’t want groups to be equal in terms of participants, e.g.&nbsp;between-subject studies. On the other hand, we might wish for groups to be perfectly equal when we perform within-subject studies. Thus, asking whether groups are comparable is unrelated to whether the subjects in our study are the same. Instead, we are looking at the characteristics of our groups. Some commonly considered features include:</p>
<ul>
<li><p><em>Size</em>: Are the groups about equally large?</p></li>
<li><p><em>Time</em>: Was the data collected around the same time?</p></li>
<li><p><em>Exogenous variables</em>: Is the distribution of characteristics we are not interested in approximately the same across groups?</p></li>
</ul>
<p>When we compare groups, we want to minimise the systematic differences that are not the primary focus of our study. Using the right sampling technique can help with this matter. For example, using a random sample and performing a random allocation to groups can help achieve comparable groups and remove systematic differences in a way no other sampling strategy can. However, there is still no guarantee that they will be comparable <span class="citation" data-cites="altman1985comparability">Berger (<a href="references.html#ref-berger2006review" role="doc-biblioref">2006</a>)</span>. Besides, we also face the challenge that in Social Sciences, we do not always have the option of random sampling. For example, International Business studies heavily rely on lists provided by others (e.g.&nbsp;the European Union, Fortune 500, etc.), personal judgement and convenience sampling. Only a small proportion perform probability sampling <span class="citation" data-cites="yang2006-IBmethods">(<a href="references.html#ref-yang2006-IBmethods" role="doc-biblioref">Yang, Wang, and Su 2006</a>)</span>. In short, there is no reason to worry if your sampling technique is not random. However, it emphasises the need to understand your sample and your groups thoroughly. To inspect characteristics of groups we wish to compare, we can use descriptive statistics as we covered them in <a href="08_descriptive_statistics.html" class="quarto-xref"><span>Chapter 8</span></a>). However, this time, we apply these techniques to subsets of our data and not the entire dataset.</p>
<p>For example, we might wish to compare <code>female</code> and <code>male</code> Egyptians (see <a href="#sec-two-unpaired-groups" class="quarto-xref"><span>Section 11.2.1</span></a>). If we wanted to make sure these two groups can be compared, we might have to check (among other characteristics) whether their <code>age</code> is distributed similarly. We can use the functions we already know to create a plot to investigate this matter and apply the function <code>facet_wrap()</code> at the end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only select participants from 'Egypt'</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Egypt"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distribution using facet_wrap()</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>comp <span class="sc">|&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age)) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/comparability-of-egyptians-filter-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The function <code>facet_wrap(~ gender)</code> allows us to create two plots based on a grouping variable, i.e.&nbsp;<code>gender</code>. We have to use a tilde (<code>~</code>) to indicate the group. This character is related to writing formulas in <em>R</em>, which we will cover in more detail in the following chapters. Being able to place plots next to each other can be very beneficial for comparison. This way, inspecting the normality across multiple groups can be done within seconds. On the other hand, creating separate plots for each group can take a long time, for example, comparing 48 countries.</p>
<p>Alternatively, we could also create density plots using the <code>ggridges</code> package, which puts all the plots onto the same x-axis, making it even easier to see the differences across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot distributions</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>comp <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> gender,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges</span>(<span class="at">bandwidth =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/comparability-of-egyptians-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In light of both data visualisations, we can conclude that the distribution of <code>age</code> across both <code>gender</code> groups is fairly similar and likely not different between groups. Of course, we could also statistically explore this using a suitable test before performing the main group comparison. However, we first have to understand how we can perform such tests.</p>
<p>In the following chapters, we will primarily rely on the package <code>rstatix</code>, which offers a pipe-friendly approach to using the built-in functions of <em>R</em> to perform our group comparisons. However, you are welcome to try the basic functions, which you can find in the Appendix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-comparing-two-groups" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sec-comparing-two-groups"><span class="header-section-number">11.2</span> Comparing two groups</h2>
<p>The simplest of comparisons is the one where you only have two groups. These groups could either consist of different people (unpaired) or represent two measurements of the same individuals (paired). We will cover scenarios in the following chapter because they require slightly different computational techniques.</p>
<section id="sec-two-unpaired-groups" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="sec-two-unpaired-groups"><span class="header-section-number">11.2.1</span> Two unpaired groups</h3>
<p>An unpaired group test assumes that the observations in each group are not related to each other, for example, observations in each group are collected from different individuals.</p>
<p>Our first comparison will be participants from <code>Egypt</code>, and we want to understand whether <code>male</code> and <code>female</code> citizens in this country perceive their <code>freedom_of_choice</code> differently or equally.</p>
<p>We first can compare these two groups using our trusty <code>geom_boxplot()</code> (or any variation) and use different <code>fill</code> colours for each group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean for and size of each group</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  comp <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(freedom_of_choice),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>group_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  gender  mean     n
  &lt;fct&gt;  &lt;dbl&gt; &lt;int&gt;
1 female  6.21   579
2 male    6.82   621</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create our data visualisation</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>comp <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> freedom_of_choice, <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the mean for each group</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> group_means,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> mean),</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">3</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/two-unpaired-groups-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While the distribution looks similar, we notice that the median and the mean (marked by the cross inside the boxplot) are slightly higher for <code>male</code> participants. Thus, we can suspect some differences between these two groups, but we do not know whether these differences are significant or not. Therefore, to consider the significance (remember <a href="10_correlations.html#sec-significance" class="quarto-xref"><span>Section 10.3</span></a>) and the effect size (see <a href="10_correlations.html#tbl-effect-size-cohen" class="quarto-xref">Table&nbsp;<span>10.2</span></a>), we have to perform statistical tests.</p>
<p><a href="#tbl-comparing-two-groups-unpaired" class="quarto-xref">Table&nbsp;<span>11.1</span></a> summarises the different tests and functions to perform the group comparison computationally. It is important to note that the parametric test compares the means of two groups, while the non-parametric test compares medians. All of these tests turn significant if the differences between groups are large enough. Thus, significant results can be read as ‘these groups are significantly different from each other’. Of course, if the test is not significant, the groups are considered to be not different. For parametric tests, i.e.&nbsp;<code>t_test(),</code> it is also essential to indicate whether the variances between these two groups are equal or not. Remember, the equality of variances was one of the assumptions for parametric tests. The <em>Welch t-test</em> can be used if the variances are not equal, but all other criteria for normality are met. By setting <code>var.equal = TRUE</code>, a regular <em>T-Test</em> would be performed. By default, <code>t_test()</code> assumes that variances are not equal. Make sure you test for <em>homogeneity of variance</em> before making your decision (see <a href="09_sources_of_bias.html#sec-homogeneity-of-variance" class="quarto-xref"><span>Section 9.5</span></a>).</p>
<div id="tbl-comparing-two-groups-unpaired" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparing-two-groups-unpaired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.1: Comparing two unpaired groups
</figcaption>
<div aria-describedby="tbl-comparing-two-groups-unpaired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 13%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Test</th>
<th>Function</th>
<th>Effect size</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Parametric</td>
<td><p>T-Test</p>
<p>Welch T-Test</p></td>
<td><p><code>t_test(var.equal = TRUE)</code></p>
<p><code>t_test(var.equal = FALSE)</code></p></td>
<td>Cohen’s d</td>
<td><code>cohens_d()</code></td>
</tr>
<tr class="even">
<td>Non-parametric</td>
<td>Mann-Whitney U</td>
<td><code>wilcox_test(paired = FALSE)</code></td>
<td>Wilcoxon R</td>
<td><code>wilcox_effsize()</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>With this information in hand, we can start comparing the <code>female</code> Egyptians with the <code>male</code> ones using both the parametric and the non-parametric test for illustration purposes only. By setting <code>detailed = TRUE</code>, we can obtain the maximum amount of information for certain comparisons. In such cases, it is advisable to use <code>glimpse()</code>. This will make the output (a <code>tibble</code>) easier to read because each row presents one piece of information, rather than having one row with many columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># T-Test</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>comp <span class="sc">|&gt;</span> <span class="fu">t_test</span>(freedom_of_choice <span class="sc">~</span> gender,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">detailed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 15
$ estimate    &lt;dbl&gt; -0.6120414
$ estimate1   &lt;dbl&gt; 6.212435
$ estimate2   &lt;dbl&gt; 6.824477
$ .y.         &lt;chr&gt; "freedom_of_choice"
$ group1      &lt;chr&gt; "female"
$ group2      &lt;chr&gt; "male"
$ n1          &lt;int&gt; 579
$ n2          &lt;int&gt; 621
$ statistic   &lt;dbl&gt; -4.75515
$ p           &lt;dbl&gt; 2.22e-06
$ df          &lt;dbl&gt; 1198
$ conf.low    &lt;dbl&gt; -0.864566
$ conf.high   &lt;dbl&gt; -0.3595169
$ method      &lt;chr&gt; "T-test"
$ alternative &lt;chr&gt; "two.sided"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch t-test (var.equal = FALSE by default)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>comp <span class="sc">|&gt;</span> <span class="fu">t_test</span>(freedom_of_choice <span class="sc">~</span> gender,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">var.equal =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">detailed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 15
$ estimate    &lt;dbl&gt; -0.6120414
$ estimate1   &lt;dbl&gt; 6.212435
$ estimate2   &lt;dbl&gt; 6.824477
$ .y.         &lt;chr&gt; "freedom_of_choice"
$ group1      &lt;chr&gt; "female"
$ group2      &lt;chr&gt; "male"
$ n1          &lt;int&gt; 579
$ n2          &lt;int&gt; 621
$ statistic   &lt;dbl&gt; -4.756287
$ p           &lt;dbl&gt; 2.21e-06
$ df          &lt;dbl&gt; 1193.222
$ conf.low    &lt;dbl&gt; -0.8645067
$ conf.high   &lt;dbl&gt; -0.3595762
$ method      &lt;chr&gt; "T-test"
$ alternative &lt;chr&gt; "two.sided"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mann-Withney U test</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>comp <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(freedom_of_choice <span class="sc">~</span> gender,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">detailed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 12
$ estimate    &lt;dbl&gt; -0.999948
$ .y.         &lt;chr&gt; "freedom_of_choice"
$ group1      &lt;chr&gt; "female"
$ group2      &lt;chr&gt; "male"
$ n1          &lt;int&gt; 579
$ n2          &lt;int&gt; 621
$ statistic   &lt;dbl&gt; 149937.5
$ p           &lt;dbl&gt; 4.97e-07
$ conf.low    &lt;dbl&gt; -0.9999694
$ conf.high   &lt;dbl&gt; -5.79946e-05
$ method      &lt;chr&gt; "Wilcoxon"
$ alternative &lt;chr&gt; "two.sided"</code></pre>
</div>
</div>
<p>You might notice that the notation within the functions for group tests looks somewhat different to what we are used to, i.e.&nbsp;we use the <code>~</code> (‘tilde’) symbol. This is because some functions take a formula as their attribute, and to distinguish the dependent and independent variables from each other, we use <code>~</code>. A more generic notation of how formulas in functions work is shown below, where <code>DV</code> stands for <em>‘dependent variable’</em> and <code>IV</code> stands for <em>‘independent variable’</em>:</p>
<div id="formulas-in-functions" data-align="center">
<p>function(formula = DV ~ IV)</p>
</div>
<p>Even for multiple groups, group comparisons usually only have one independent variable, i.e.&nbsp;the grouping variable. Grouping variables are generally of the type <code>factor</code>. In the case of two groups, we have two levels present in this factor. For example, our variable <code>gender</code> contains two levels: <code>female</code> and <code>male</code>. If there are multiple groups, the factor comprises various levels, e.g.&nbsp;the variable <code>country</code> includes levels of 48 countries.</p>
<p>No matter which test we run, it appears as if the difference is significant. However, how big/important is the difference? The effect size provides the answer to this. The interpretation of the effect size follows the explanations in <a href="10_correlations.html" class="quarto-xref"><span>Chapter 10</span></a>, where we looked at the strength of the correlation of two variables. However, different analytical techniques require different effect size measures, implying that we have to use different benchmarks. To help us with the interpretation, we can use the <code>effectsize</code> package and their set of <code>interpret_*()</code> functions (see also <a href="https://easystats.github.io/effectsize/articles/interpret.html" target="blank" title="Indices of Effect Size">Indices of Effect Sizes</a>). Sometimes, there are even more than one way of computing the effect size. For example, we can choose between the classic Wilcoxon R or the rank-biserial correlation coefficient for the Mann-Whitney test. In practice, you have to be explicit about how you computed the effect size. The differences between the two measures are often marginal and a matter of taste (or should I say: Your reviewers’ taste). Throughout this chapter, I will rely on the effect sizes most commonly found in Social Sciences publications. However, feel free to explore other indices as well, especially those offered in the <code>effectsize</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After parametric test</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    comp <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cohens_d</span>(freedom_of_choice <span class="sc">~</span> gender,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
  .y.             group1 group2 effsize    n1    n2 conf.low conf.high magnitude
* &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;ord&gt;    
1 freedom_of_cho… female male    -0.275   579   621     -0.4     -0.15 small    </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_cohens_d</span>(d<span class="sc">$</span>effsize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d 
  "small" 
(Rules: cohen1988)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After non-parametric test</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>(wr <span class="ot">&lt;-</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    comp <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">wilcox_effsize</span>(freedom_of_choice <span class="sc">~</span> gender,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ci =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 9
  .y.             group1 group2 effsize    n1    n2 conf.low conf.high magnitude
* &lt;chr&gt;           &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;ord&gt;    
1 freedom_of_cho… female male     0.145   579   621     0.09       0.2 small    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_r</span>(wr<span class="sc">$</span>effsize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect size (r) 
        "small" 
(Rules: funder2019)</code></pre>
</div>
</div>
<p>Looking at our test results, the <code>female</code> Egyptians perceive <code>freedom_of_choice</code> differently from their <code>male</code> counterparts. This is in line with our boxplots. However, the effect sizes tend to be small, which means the differences between the two groups is marginal. Similar to correlations, group comparisons need to be analysed in two stages, answering two questions:</p>
<ol type="1">
<li><p>Is the difference between groups significant?</p></li>
<li><p>If it is significant, is the difference small, medium or large?</p></li>
</ol>
<p>Combining both analytical steps gives us a comprehensive answer to our research question and enables us to derive meaningful conclusions. This applies to all group comparisons covered in this book.</p>
</section>
<section id="sec-two-paired-groups" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="sec-two-paired-groups"><span class="header-section-number">11.2.2</span> Two paired groups</h3>
<p>Sometimes, we are not interested in the difference between subjects, but within them, i.e., we want to know whether the same person provides similar or different responses at two different times. Thus, it becomes evident that observations need to be somehow linked to each other. Paired groups are frequently used in longitudinal and experimental studies (e.g., pre-test vs post-test). For example, we might be interested to know whether people in England experienced different levels of anxiety over time. By analysing data provided in <code>hie_15_21</code>, we can examine changes in anxiety levels within the same population between <code>2015</code> and <code>2021</code> and find an answer to our question.</p>
<p>Let us begin our investigative journey by creating boxplots to compare the levels of anxiety from <code>2015</code> with those from <code>2021</code>. However, in a first step, we need to convert the variable <code>year</code>, which is a numeric value in this dataset, into a factor. This will allow us to treat each year as a grouping variables for the entirety of our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hie_comp <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  hie_15_21 <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert numeric data into categorical data</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as_factor</span>(year))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>hie_comp <span class="sc">|&gt;</span>  </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create boxplots</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> feelings_of_anxiety,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/two-paired-groups-boxplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Considering this plot, we can ascertain that there is a slight increase in <code>feelings_of_anxiety</code> which is concerning. However, it is tough to say whether these differences are large, significant and, therefore, important. Instead we likely have to find a way to assess this statistically by crunching the numbers.</p>
<p><a href="#tbl-comparing-two-groups-paired" class="quarto-xref">Table&nbsp;<span>11.2</span></a> summarises which tests and functions need to be performed when our data is parametric or non-parametric. In both cases, the functions are the same as those of the unpaired group comparisons, but we need to add the attribute <code>paired = TRUE</code>. Still, the interpretations between the unpaired and paired tests remain the same. Also, be aware that some tests have changed in name, e.g.&nbsp;the Mann-Whitney U test has become the Wilcoxon Signed Rank Test. Even though we use the same functions as before, by changing the attribute <code>paired</code> to <code>TRUE</code>, we also change the computational technique to obtain the results. Thus, remember that the same function can perform different computations which are not comparable. While this practice is handy, because it is easier to remember a function, it can also easily lead to mistakes if the wrong parameters were set.</p>
<div id="tbl-comparing-two-groups-paired" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparing-two-groups-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.2: Comparing two paired groups
</figcaption>
<div aria-describedby="tbl-comparing-two-groups-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 24%">
<col style="width: 27%">
<col style="width: 12%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Test</th>
<th>Function</th>
<th>Effect size</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Parametric</td>
<td>T-Test</td>
<td><code>t_test(paired = TRUE)</code></td>
<td>Cohen’s d</td>
<td><code>cohens_d()</code></td>
</tr>
<tr class="even">
<td>Non-parametric</td>
<td>Wilcoxon Signed Rank Test</td>
<td><code>wilcox_test(paired = TRUE)</code></td>
<td>Wilcoxon r</td>
<td><code>wilcox_effsize()</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Let’s apply these functions to find out whether the differences we can see in our plot matter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paired T-Test</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>hie_comp <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(feelings_of_anxiety <span class="sc">~</span> year,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">var.equal =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">detailed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 13
$ estimate    &lt;dbl&gt; -0.2539739
$ .y.         &lt;chr&gt; "feelings_of_anxiety"
$ group1      &lt;chr&gt; "2015"
$ group2      &lt;chr&gt; "2021"
$ n1          &lt;int&gt; 307
$ n2          &lt;int&gt; 307
$ statistic   &lt;dbl&gt; -10.6258
$ p           &lt;dbl&gt; 1.18e-22
$ df          &lt;dbl&gt; 306
$ conf.low    &lt;dbl&gt; -0.3010063
$ conf.high   &lt;dbl&gt; -0.2069416
$ method      &lt;chr&gt; "T-test"
$ alternative &lt;chr&gt; "two.sided"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon Signed Rank Test</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>hie_comp <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(feelings_of_anxiety <span class="sc">~</span> year,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 7
$ .y.       &lt;chr&gt; "feelings_of_anxiety"
$ group1    &lt;chr&gt; "2015"
$ group2    &lt;chr&gt; "2021"
$ n1        &lt;int&gt; 307
$ n2        &lt;int&gt; 307
$ statistic &lt;dbl&gt; 8151
$ p         &lt;dbl&gt; 1.9e-22</code></pre>
</div>
</div>
<p>Irrespective of whether we use a parametric or non-parametric test, the results (<span class="math inline">\(p &lt; 0.05\)</span>) clearly point towards a significant change in levels of anxiety experienced in the England between <code>2015</code> and <code>2021</code>: People seem to be more anxious than they used to be. Therefore, our next question has to be: How big are these differences, and are they important? In other words, we need to find out how large the effect size is.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## After T-Test</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(feelings_of_anxiety <span class="sc">~</span> year,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> hie_15_21,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 7
$ .y.       &lt;chr&gt; "feelings_of_anxiety"
$ group1    &lt;chr&gt; "2015"
$ group2    &lt;chr&gt; "2021"
$ effsize   &lt;dbl&gt; -0.6064463
$ n1        &lt;int&gt; 307
$ n2        &lt;int&gt; 307
$ magnitude &lt;ord&gt; moderate</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_cohens_d</span>(d<span class="sc">$</span>effsize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d 
 "medium" 
(Rules: cohen1988)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After Wilcoxon Signed Rank Test</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>wr <span class="ot">&lt;-</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  hie_15_21 <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_effsize</span>(feelings_of_anxiety <span class="sc">~</span> year,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(wr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 9
$ .y.       &lt;chr&gt; "feelings_of_anxiety"
$ group1    &lt;chr&gt; "2015"
$ group2    &lt;chr&gt; "2021"
$ effsize   &lt;dbl&gt; 0.5574338
$ n1        &lt;int&gt; 307
$ n2        &lt;int&gt; 307
$ conf.low  &lt;dbl&gt; 0.47
$ conf.high &lt;dbl&gt; 0.64
$ magnitude &lt;ord&gt; large</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_r</span>(wr<span class="sc">$</span>effsize, <span class="at">rules =</span> <span class="st">"cohen1988"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect size (r) 
        "large" 
(Rules: cohen1988)</code></pre>
</div>
</div>
<p>The results further confirm that <code>feelings_of_anxiety</code> have gone up substantially within six years, reporting either a <code>moderate</code> effect for the parametric test and even a <code>large</code> effect for the non-parametric equivalent. While both tests point in the right direction, it is noteworthy that our interpretations might slightly differ, given the interpretation of effect sizes. This highlights the importance of determining the appropriate method before conducting any analysis. Like many other statistical software programs, <em>R</em> can perform various analyses, but that does not necessarily mean it is the correct approach.</p>
<p>While we completed all analytical steps diligently, one might still be puzzled by this outcome. What exactly caused an increase in anxiety in England? Unfortunately, the numbers would not provide any insights into this question. Instead, considering the political changes and the COVID-pandemic during this time might offer some possible explanations.</p>
</section>
</section>
<section id="sec-comparing-more-than-two-groups" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="sec-comparing-more-than-two-groups"><span class="header-section-number">11.3</span> Comparing more than two groups</h2>
<p>Often we find ourselves in situations where comparing two groups is not enough. Instead, we might be faced with three or more groups reasonably quickly. For example, the <code>wvs_nona</code> dataset allows us to look at 48 different countries, all of which we could compare very effectively with just a few lines of code. In the following chapters, we look at how we can perform the same type of analysis as before, but with multiple unpaired and paired groups using <em>R</em>. Similarly to the two-samples group comparison, we cover the parametric and non-parametric approaches.</p>
<section id="sec-multiple-unpaired-groups" class="level3" data-number="11.3.1">
<h3 data-number="11.3.1" class="anchored" data-anchor-id="sec-multiple-unpaired-groups"><span class="header-section-number">11.3.1</span> Multiple unpaired groups</h3>
<p>Have you ever been wondering whether people in different countries are equally satisfied with their lives? You might have a rough guess that it is not the case because the social, economic and political environment might play an important role. For example, if you live in a country affected by social conflicts, one’s life satisfaction might be drastically lower. In the following, we take a look at three countries <code>Iraq</code>, <code>Japan</code> and <code>Korea</code>. I chose these countries out of personal interest and because they nicely demonstrate the purpose of the chapter, i.e.&nbsp;finding out whether there are differences in the perception of <code>satisfaction</code> across three countries. At any time, feel free to remove the <code>filter()</code> function to gain the results of all countries in the dataset, but prepare for slightly longer computation times. We first create the dataset, which only contains the three desired countries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mcomp <span class="ot">&lt;-</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Iraq"</span> <span class="sc">|</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>           country <span class="sc">==</span> <span class="st">"Japan"</span> <span class="sc">|</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>           country <span class="sc">==</span> <span class="st">"Korea"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similar to before, we can use the <code>ggridges</code> package to draw density plots for each group. This has the added benefit that we can compare the distribution of data for each group and see whether the assumption of normality is likely met or not. On the other hand, we lose the option to identify any outliers quickly. You win some, and you lose some.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mcomp <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">|&gt;</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> satisfaction,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">reorder</span>(country, satisfaction),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> country)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">stat_density_ridges</span>(<span class="at">bandwidth =</span> <span class="fl">0.6</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">quantile_lines =</span> <span class="cn">TRUE</span>,   <span class="co"># adds median indicator</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">quantiles =</span> (<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove legend</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/multiple-unpaired-groups-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot shows us that <code>Japan</code> and <code>Korea</code> appear to be very similar, if not identical (based on the median), but <code>Iraq</code> appears to be different from the other two groups. When performing a multiple group comparison, we can follow similar steps as before with two groups, i.e.</p>
<ul>
<li><p>perform the comparison,</p></li>
<li><p>determine the effect size, and</p></li>
<li><p>interpret the effect size.</p></li>
</ul>
<p><a href="#tbl-comparing-multiple-groups-unpaired" class="quarto-xref">Table&nbsp;<span>11.3</span></a> summarises which test needs to be chosen to compare multiple unpaired groups and their corresponding effect size measures.</p>
<div id="tbl-comparing-multiple-groups-unpaired" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparing-multiple-groups-unpaired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.3: Comparing multiple unpaired groups (effect size functions from package <code>effectsize</code>)
</figcaption>
<div aria-describedby="tbl-comparing-multiple-groups-unpaired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 27%">
<col style="width: 15%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Test</th>
<th>Function for test</th>
<th>Effect size</th>
<th>Function for effect size<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Parametric</td>
<td>ANOVA</td>
<td><ul>
<li><code>anova_test</code> (assumes equal variances)</li>
<li><code>oneway.test(var.equal = TRUE/FALSE)</code></li>
</ul></td>
<td>Eta squared</td>
<td><code>eta_squared()</code></td>
</tr>
<tr class="even">
<td>Non-parametric</td>
<td>Kruskall-Wallis test</td>
<td><code>kruskal_test()</code></td>
<td>Epsilon squared (rank)</td>
<td><code>rank_epsilon_squared()</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Let’s begin by conducting the group comparison. As you will notice, <code>rstatix</code> currently does not support a parametric test where <code>var.equal = FALSE</code>. Therefore we need to fall back to the underlying function <code>oneway.test(var.equal = FALSE)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="do">## equal variances assumed</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>mcomp <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(satisfaction <span class="sc">~</span> country,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">detailed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type II tests)

   Effect      SSn      SSd DFn  DFd       F         p p&lt;.05   ges
1 country 4258.329 11314.68   2 3795 714.133 5.74e-264     * 0.273</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Equal variances not assumed</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>(oneway_test <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(satisfaction <span class="sc">~</span> country,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> mcomp,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">var.equal =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-way analysis of means (not assuming equal variances)

data:  satisfaction and country
F = 663.17, num df = 2.0, denom df = 2422.8, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Kruskall-Wallis test</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>mcomp <span class="sc">|&gt;</span> <span class="fu">kruskal_test</span>(satisfaction <span class="sc">~</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .y.              n statistic    df         p method        
* &lt;chr&gt;        &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;         
1 satisfaction  3798     1064.     2 1.11e-231 Kruskal-Wallis</code></pre>
</div>
</div>
<p>While <code>anova_test()</code> does provide the effect size automatically, i.e.&nbsp;generalised eta squared (<code>ges</code>), this is not the case for the other two approaches. Therefore, we have to use the <code>effectsize</code> package to help us out. Packages often can get you a long way and make your life easier, but it is good to know alternatives if a single package does not give you what you need.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># After ANOVA with var.equal = FALSE</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">eta_squared</span>(oneway_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Eta2 |       95% CI
-------------------
0.35 | [0.33, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># effect size rank epsilon squared</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">rank_epsilon_squared</span>(mcomp<span class="sc">$</span>satisfaction <span class="sc">~</span> mcomp<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epsilon2 (rank) |       95% CI
------------------------------
2.12e-03        | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>The results show that there is a significant and large difference between these groups. You might argue that this is not quite true. Considering our plot, we know that Japan and Korea do not look as if they are significantly different. Multiple group comparisons only consider differences across all three groups. Therefore, if one group differs from the other groups, the test will turn significant and even provide a large enough effect size to consider it essential. However, these tests do not provide information on which differences between groups are significant. To gain more clarification about this, we need to incorporate another step called <em>‘post-hoc tests’</em>. These tests compare two groups at a time, which is why they are also known as <em>‘pairwise comparisons’</em>. Compared to regular two-sample tests, these perform corrections of the <code>p</code>-values for multiple testing, which is necessary. However, there are many different <em>‘post-hoc’ tests</em> you can choose. <span class="citation" data-cites="field2013discovering">Field (<a href="references.html#ref-field2013discovering" role="doc-biblioref">2013</a>)</span> (p.459) nicely outlines the different scenarios and provides recommendations to navigate this slightly complex field of <em>post-hoc tests</em>. <a href="#tbl-post-hoc-tests" class="quarto-xref">Table&nbsp;<span>11.4</span></a> provides an overview of his suggestions.</p>
<div id="tbl-post-hoc-tests" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-post-hoc-tests-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.4: Different post-hoc tests for different scenarios (parametric)
</figcaption>
<div aria-describedby="tbl-post-hoc-tests-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Equal sample size</th>
<th>Equal variances</th>
<th>Post-hot tests</th>
<th>Functions in R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>YES</td>
<td>YES</td>
<td><ul>
<li><p>REGWQ,</p></li>
<li><p>Tukey,</p></li>
<li><p>Bonferroni</p></li>
</ul></td>
<td><ul>
<li><p><code>mutoss::regwq()</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p></li>
<li><p><code>rstatix::tukey_hsd()</code></p></li>
<li><p><code>pairwise.t.test(p.adjust.method = "bonferroni")</code></p></li>
</ul></td>
</tr>
<tr class="even">
<td>NO (slightly different)</td>
<td>YES</td>
<td><ul>
<li>Gabriel</li>
</ul></td>
<td></td>
</tr>
<tr class="odd">
<td>YES</td>
<td>YES</td>
<td><ul>
<li>Hochberg’s GT2</li>
</ul></td>
<td><ul>
<li>Not available in R and should not be confused with <code>pairwise.t.test(p.adjust.method = "hochberg")</code>, which is based on <span class="citation" data-cites="hochberg1988sharper">Hochberg (<a href="references.html#ref-hochberg1988sharper" role="doc-biblioref">1988</a>)</span>. The GT2, however, is based on <span class="citation" data-cites="hochberg1974some">Hochberg (<a href="references.html#ref-hochberg1974some" role="doc-biblioref">1974</a>)</span>.</li>
</ul></td>
</tr>
<tr class="even">
<td>NO (not ideal for small samples)</td>
<td>NO</td>
<td><ul>
<li>Games-Howell</li>
</ul></td>
<td><ul>
<li><code>rstatix::games_howell_test()</code></li>
</ul></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>You might be surprised to see that there are also <em>post-hoc tests</em> for parametric group comparisons when equal variances are not assumed. Would we not have to use a non-parametric test for our group comparison instead? Well, empirical studies have demonstrated that ANOVAs tend to produce robust results, even if the assumption of normality <span class="citation" data-cites="blanca2017non">(e.g. <a href="references.html#ref-blanca2017non" role="doc-biblioref">Blanca Mena et al. 2017</a>)</span> is not given, or there is some degree of heterogeneity of variance between groups <span class="citation" data-cites="tomarken1986comparison">(<a href="references.html#ref-tomarken1986comparison" role="doc-biblioref">Tomarken and Serlin 1986</a>)</span>. In other words, there can be some lenieancy (or flexibility?) when it comes to the violation of parametric assumptions. If you want to reside on the save side, you should ensure you know your data and its properties. If in doubt, non-parametric tests are also available.</p>
<p>If we want to follow up the Kruskal-Wallis test, i.e.&nbsp;the non-parametric equivalent to the one-way ANOVA, we can make use of two <em>post-hoc tests</em>:</p>
<ul>
<li>Dunn Test: <code>rstatix::dunn_test()</code> <span class="citation" data-cites="dinno2015nonparametric">(<a href="references.html#ref-dinno2015nonparametric" role="doc-biblioref">Dinno 2015</a>)</span></li>
<li>Pairwise comparison with Bonferroni (and other) correction: <code>pairwise.wilcox.test()</code>.</li>
</ul>
<p>Below are some examples of how you would use these functions in your project. However, be aware that some of the <em>post-hoc tests</em> are not well implemented yet in <em>R</em>. Here, I show the most important ones that likely serve you in 95% of the cases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># POST-HOC </span><span class="al">TEST</span><span class="co"> FOR PARAMETRIC DATA</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Bonferroni</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(mcomp<span class="sc">$</span>satisfaction,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                mcomp<span class="sc">$</span>country,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  mcomp$satisfaction and mcomp$country 

      Iraq   Japan
Japan &lt;2e-16 -    
Korea &lt;2e-16 1    

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>mcomp <span class="sc">|&gt;</span> <span class="fu">tukey_hsd</span>(satisfaction <span class="sc">~</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 9
  term    group1 group2 null.value estimate conf.low conf.high        p.adj
* &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 country Iraq   Japan           0   2.29      2.13      2.45  0.0000000141
2 country Iraq   Korea           0   2.26      2.10      2.43  0.0000000141
3 country Japan  Korea           0  -0.0299   -0.189     0.129 0.898       
# ℹ 1 more variable: p.adj.signif &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Games-Howell</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>mcomp <span class="sc">|&gt;</span> <span class="fu">games_howell_test</span>(satisfaction <span class="sc">~</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  .y.          group1 group2 estimate conf.low conf.high    p.adj p.adj.signif
* &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
1 satisfaction Iraq   Japan    2.29      2.11      2.47  0        ****        
2 satisfaction Iraq   Korea    2.26      2.11      2.42  5.71e-11 ****        
3 satisfaction Japan  Korea   -0.0299   -0.178     0.118 8.84e- 1 ns          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># POST-HOC </span><span class="al">TEST</span><span class="co"> FOR NON-PARAMETRIC DATA</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>mcomp <span class="sc">|&gt;</span> <span class="fu">dunn_test</span>(satisfaction <span class="sc">~</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 9
  .y.       group1 group2    n1    n2 statistic         p     p.adj p.adj.signif
* &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;       
1 satisfac… Iraq   Japan   1200  1353     29.2  4.16e-187 1.25e-186 ****        
2 satisfac… Iraq   Korea   1200  1245     27.6  8.30e-168 1.66e-167 ****        
3 satisfac… Japan  Korea   1353  1245     -1.02 3.10e-  1 3.10e-  1 ns          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(mcomp<span class="sc">$</span>satisfaction,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                     mcomp<span class="sc">$</span>country,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  mcomp$satisfaction and mcomp$country 

      Iraq    Japan  
Japan &lt; 2e-16 -      
Korea &lt; 2e-16 0.00093

P value adjustment method: holm </code></pre>
</div>
</div>
<p>As we can see, no matter which function we use, the interpretation of the results remain the same on this occasion. This is, of course reassuring to know, because it implies that the method chosen does not change the outcome.</p>
</section>
<section id="sec-multiple-paired-groups" class="level3" data-number="11.3.2">
<h3 data-number="11.3.2" class="anchored" data-anchor-id="sec-multiple-paired-groups"><span class="header-section-number">11.3.2</span> Multiple paired groups</h3>
<p>When comparing multiple paired groups, matters become slightly more complicated. On the one hand, our groups are not really groups anymore because our data refer to the same group of people, usually over an extended period of time. In experimental studies, this can also refer to different <em>‘treatments’</em> or <em>‘conditions’</em>. This is similar to comparing two paired groups. On the other hand, we also have to deal with yet another assumption: <em>Sphericity</em>.</p>
<section id="sec-sphericity" class="level4" data-number="11.3.2.1">
<h4 data-number="11.3.2.1" class="anchored" data-anchor-id="sec-sphericity"><span class="header-section-number">11.3.2.1</span> Testing the assumption of sphericity</h4>
<p>Sphericity assumes that the variance of covariate pairs (i.e.&nbsp;any combination of the groups/treatments) are roughly equal. This might sound familiar to the assumption of <em>homogeneity of variance</em> in between-subject ANOVAs, only that we look at differences between pairs and not between two different participant groups. Thus, it seems less surprising that the parametric test to compare multiple paired groups is also called <em>‘repeated measures ANOVA’</em>.</p>
<p>To illustrate the concept of <em>sphericity</em>, let’s look at an example. Assume we conduct a longitudinal study that involves five university students who started their studies in a foreign country. We ask them to complete a survey that tests their level of integration into the local community at three points in time: month 1 (<code>m1</code>), month 4 (<code>m4</code>) and month 8 (<code>m8)</code>. This gives us the following dataset:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `across(where(is.double), round, 0)`.
Caused by warning:
! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
Supply arguments directly to `.fns` through an anonymous function instead.

  # Previously
  across(a:b, mean, na.rm = TRUE)

  # Now
  across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>acculturation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  name        m1    m4    m8
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Waylene      2     3     5
2 Nicole       1     3     6
3 Mikayla      2     3     5
4 Valeria      1     3     5
5 Giavanni     1     3     5</code></pre>
</div>
</div>
<p>If each month measured a different group of participants, we would compare the differences between each month regarding homogeneity. However, since we look at paired data, we need to consider the differences in pairs of measures. In this study, the following combinations are possible:</p>
<ul>
<li><p><code>m1</code> and <code>m4</code></p></li>
<li><p><code>m4</code> and <code>m8</code></p></li>
<li><p><code>m1</code> and <code>m8</code></p></li>
</ul>
<p>Let’s add the differences between measures for each participant based on these pairs and compute the variances across these values using the function <code>var()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the differences across all three pairs of measurements</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  acculturation <span class="sc">|&gt;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m1_m4 =</span> m1 <span class="sc">-</span> m4,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">m4_m8 =</span> m4 <span class="sc">-</span> m8,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">m1_m8 =</span> m1 <span class="sc">-</span> m8)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>differences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  name        m1    m4    m8 m1_m4 m4_m8 m1_m8
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Waylene      2     3     5    -1    -2    -3
2 Nicole       1     3     6    -2    -3    -5
3 Mikayla      2     3     5    -1    -2    -3
4 Valeria      1     3     5    -2    -2    -4
5 Giavanni     1     3     5    -2    -2    -4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the variance for each pair</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>differences <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">m1_m4_var =</span> <span class="fu">var</span>(m1_m4),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">m4_m8_var =</span> <span class="fu">var</span>(m4_m8),</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">m1_m8_var =</span> <span class="fu">var</span>(m1_m8))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  m1_m4_var m4_m8_var m1_m8_var
      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1       0.3       0.2       0.7</code></pre>
</div>
</div>
<p>We can tell that the differences across groups are relatively small when comparing <code>m1_m4_var</code> and <code>m4_m8_var</code>. However, the value for <code>m1_m8_var</code> appears bigger. So, how can we be sure whether the assumption of sphericity is violated or not? Similar to many of the other assumptions we covered, a significance test provides the answer to this question. For multiple paired groups, we use <em>Mauchly’s Test of Sphericity</em>. If the test is significant, the variances across groups are not equal. In other words, a significant Mauchly test implies a violation of sphericity. The <code>rstatix</code> package includes Mauchly’s Test of Sphericity in its <code>anova_test()</code>. Thus, we get both with one function. However, our data in this example is not tidy (remember the definition from <a href="07_data_wrangling.html#sec-inspecting-raw-data" class="quarto-xref"><span>Section 7.2</span></a>?), because there are multiple observation per row for each individual and the same variable. Instead, we need to ensure that each observation for a given variable has its own row. In short, we first need to convert it into a tidy dataset using the function <code>pivot_longer()</code>. Feel free to ignore this part for now, because we will cover pivoting datasets in greater detail in <a href="#sec-chi-squared-test" class="quarto-xref"><span>Section 11.4</span></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert into tidy data</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>acc_long <span class="ot">&lt;-</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  acculturation <span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(m1, m4, m8),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"month"</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"integration"</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>acc_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
   name     month integration
   &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;
 1 Waylene  m1              2
 2 Waylene  m4              3
 3 Waylene  m8              5
 4 Nicole   m1              1
 5 Nicole   m4              3
 6 Nicole   m8              6
 7 Mikayla  m1              2
 8 Mikayla  m4              3
 9 Mikayla  m8              5
10 Valeria  m1              1
11 Valeria  m4              3
12 Valeria  m8              5
13 Giavanni m1              1
14 Giavanni m4              3
15 Giavanni m8              5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform repeated-measures ANOVA</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plus Mauchly's Test of Sphericity</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>acc_long <span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">anova_test</span>(<span class="at">dv =</span> integration,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">wid =</span> name,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">within =</span> month,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">detailed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

$ANOVA
       Effect DFn DFd   SSn SSd    F        p p&lt;.05   ges
1 (Intercept)   1   4 153.6 0.4 1536 2.53e-06     * 0.987
2       month   2   8  36.4 1.6   91 3.14e-06     * 0.948

$`Mauchly's Test for Sphericity`
  Effect     W     p p&lt;.05
1  month 0.417 0.269      

$`Sphericity Corrections`
  Effect   GGe     DF[GG]    p[GG] p[GG]&lt;.05   HFe     DF[HF] p[HF] p[HF]&lt;.05
1  month 0.632 1.26, 5.05 0.000162         * 0.788 1.58, 6.31 3e-05         *</code></pre>
</div>
</div>
<p>Not only do the results show that the differences across measures are significant, but that our Mauchly’s Test of Sphericity is not significant. Good news on all fronts.</p>
<p>The output from <code>anova_test()</code> also provides information about <code>Sphericity Corrections</code>. We need to consider these scores if the sphericity assumption is violated, i.e.&nbsp;Mauchly’s Test of Sphericity is significant. We commonly use two methods to correct the degrees of freedom in our analysis which will change the p-value of our tests: <em>Greenhouse-Geisser correction</em> <span class="citation" data-cites="greenhouse1959methods">(<a href="references.html#ref-greenhouse1959methods" role="doc-biblioref">Greenhouse and Geisser 1959</a>)</span> and <em>Huynh-Field correction</em> <span class="citation" data-cites="huynh1976estimation">(<a href="references.html#ref-huynh1976estimation" role="doc-biblioref">Huynh and Feldt 1976</a>)</span>. <span class="citation" data-cites="field2013discovering">Field (<a href="references.html#ref-field2013discovering" role="doc-biblioref">2013</a>)</span> explains that if the Greenhouse-Geisser estimate (i.e.&nbsp;<code>GGe</code>) is greater than <code>0.74</code>, it is advisable to use the Huynh-Field correction instead. For each correction, the <code>anova_test()</code> provides corrected p-values. In our example, we do not have to worry about corrections, though. Still, it is very convenient that this function delivers the corrected results as well.</p>
</section>
<section id="sec-visualising-computing-multiple-paired-group-comparisons" class="level4" data-number="11.3.2.2">
<h4 data-number="11.3.2.2" class="anchored" data-anchor-id="sec-visualising-computing-multiple-paired-group-comparisons"><span class="header-section-number">11.3.2.2</span> Visualising and computing multiple paired group comparisons</h4>
<p>So far, we blindly assumed that our data are parametric. If our assumptions for parametric tests are violated, we can draw on a non-parametric equivalent called <code>Friedman Test</code>. <a href="#tbl-comparing-multiple-groups-paired" class="quarto-xref">Table&nbsp;<span>11.5</span></a> summarises the parametric and non-parametric tests as well as their respective effect sizes.</p>
<div id="tbl-comparing-multiple-groups-paired" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparing-multiple-groups-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.5: Comparing multiple paired groups (effect size functions from package <code>effectsize</code>)
</figcaption>
<div aria-describedby="tbl-comparing-multiple-groups-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 26%">
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Assumption</th>
<th>Test</th>
<th>Function</th>
<th>Effect size</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Parametric</td>
<td>Repeated measures ANOVA</td>
<td><code>anova_test()</code></td>
<td>Eta squared</td>
<td><code>eta_squared()</code></td>
</tr>
<tr class="even">
<td>Non-parametric</td>
<td>Friedman Test</td>
<td><code>friedman_test()</code></td>
<td>Kendall’s R</td>
<td><code>kendalls_w()</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Instead of using a fictional example as we did in the previous chapter, let’s draw on real observations using the dataset <code>wvs_waves</code>. This dataset contains similar data to <code>wvs</code> but offers multiple measures as indicated by the variable <code>wave</code> for several countries. For example, we might be interested to know whether <code>satisfaction</code> changed over the years. This time, our unit of analysis is not individuals, but countries. Therefore, we compare the same countries (not individuals) over time.</p>
<p>Let’s start by visualising the data across all time periods using <code>geom_boxplot()</code>. I also added the mean for each wave since this is what we will eventually compare in our repeated-measures ANOVA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the mean for each wave</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>wave_means <span class="ot">&lt;-</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  wvs_waves <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wave) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">w_mean =</span> <span class="fu">mean</span>(satisfaction))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>wave_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  wave  w_mean
  &lt;fct&gt;  &lt;dbl&gt;
1 w1      7.14
2 w2      6.83
3 w3      7.11
4 w4      7.46
5 w5      7.54
6 w6      7.44
7 w7      7.60</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the boxplots</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>wvs_waves <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wave,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> satisfaction,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> wave)) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add the means</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> wave_means,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> wave,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> w_mean),</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/multiple-paired-groups-boxplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In total, we plotted seven boxplots that represent each wave of data collection. We can tell that <code>satisfaction</code> with life has improved slightly, especially from wave 3 (<code>w3</code>) to wave 4 (<code>w4</code>).</p>
<p>Next, we would have to check the assumptions for parametric tests. Since we have covered this in <a href="09_sources_of_bias.html" class="quarto-xref"><span>Chapter 9</span></a>, we only consider Mauchly’s Test of Sphericity by running <code>anova_test()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute repeated measures ANOVA and</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mauchly's Test of Sphericity</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>wvs_waves <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  rstatix<span class="sc">::</span><span class="fu">anova_test</span>(<span class="at">dv =</span> satisfaction,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">wid =</span> id,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">within =</span> wave)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

$ANOVA
  Effect DFn  DFd     F        p p&lt;.05   ges
1   wave   6 1794 5.982 3.33e-06     * 0.015

$`Mauchly's Test for Sphericity`
  Effect     W     p p&lt;.05
1   wave 0.903 0.067      

$`Sphericity Corrections`
  Effect   GGe        DF[GG]    p[GG] p[GG]&lt;.05   HFe        DF[HF]   p[HF]
1   wave 0.968 5.81, 1736.38 4.57e-06         * 0.989 5.94, 1774.66 3.7e-06
  p[HF]&lt;.05
1         *</code></pre>
</div>
</div>
<p>We first look at the sphericity assumption which we did not violate, i.e.&nbsp;<span class="math inline">\(p &gt; 0.05\)</span>. Thus, using the ANOVA test is appropriate. Next, we inspect the ANOVA test results and find that the differences are significant as well, i.e.&nbsp;<span class="math inline">\(p &lt; 0.05\)</span>. Still, the effect size <code>ges</code> is small.</p>
<p>From our plot, we know that some of the waves are fairly similar, and we need to determine which pair of waves are significantly different from each other. Therefore, we need a post-hoc test that allows us to perform pairwise comparisons. By now, this should sound familiar (see also <a href="#tbl-post-hoc-tests" class="quarto-xref">Table&nbsp;<span>11.4</span></a>).</p>
<p>Since we assume our data is parametric and the groups are equally large for each wave (<span class="math inline">\(n = 300\)</span>), we can use T-Tests with a Bonferroni correction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(wvs_waves<span class="sc">$</span>satisfaction,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                wvs_waves<span class="sc">$</span>wave,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using paired t tests 

data:  wvs_waves$satisfaction and wvs_waves$wave 

   w1      w2      w3      w4      w5      w6     
w2 1.00000 -       -       -       -       -      
w3 1.00000 1.00000 -       -       -       -      
w4 1.00000 0.01347 0.78355 -       -       -      
w5 0.30433 0.00033 0.11294 1.00000 -       -      
w6 1.00000 0.00547 0.68163 1.00000 1.00000 -      
w7 0.05219 0.00023 0.03830 1.00000 1.00000 1.00000

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p>Based on these insights, we find that mainly <code>w2</code> shows significant differences with other waves. This is not a coincidence because <code>w2</code> has the lowest mean of all waves. Similarly, <code>w7</code>, which reports the highest mean for satisfaction, also reports several significant differences with other groups.</p>
<p>Given the above, we can confirm that our people’s <code>satisfaction</code> with life in each country has changed positively, but the change is minimal (statistically).</p>
<p>To finish this chapter, I want to share the non-parametric version of this test: the Friedman test and its function <code>friedman_test()</code> from the <code>rstatix</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NON-PARAMETRIC COMPARISON</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>wvs_waves <span class="sc">|&gt;</span> rstatix<span class="sc">::</span><span class="fu">friedman_test</span>(satisfaction <span class="sc">~</span> wave <span class="sc">|</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .y.              n statistic    df            p method       
* &lt;chr&gt;        &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;        
1 satisfaction   300      43.4     6 0.0000000966 Friedman test</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>(kw <span class="ot">&lt;-</span> effectsize<span class="sc">::</span><span class="fu">kendalls_w</span>(satisfaction <span class="sc">~</span> wave <span class="sc">|</span> id,</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> wvs_waves))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kendall's W |       95% CI
--------------------------
0.02        | [0.02, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_kendalls_w</span>(kw<span class="sc">$</span>Kendalls_W)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "slight agreement"
(Rules: landis1977)</code></pre>
</div>
</div>
<p>The non-parametric test confirms the parametric test from before. However, the interpretation of the effect size <code>Kendall's W</code> requires some explanation. First, the effect size for Kendall’s W can range from <code>0</code> (small effect size) to <code>1</code> (large effect size). Usually, this effect size is considered when comparing inter-rater agreement, for example, the level of agreement of a jury in ice skating during the Olympic games. Thus, the interpretation offered by the function <code>interpret_kendalls_w()</code> follows this logic. As such, it is worth considering a slightly amended interpretation of Kendall’s W if our data is not based on ratings. This is shown in <a href="#tbl-effect-size-kendalls-w" class="quarto-xref">Table&nbsp;<span>11.6</span></a> based on <span class="citation" data-cites="landis1977measurement">Landis and Koch (<a href="references.html#ref-landis1977measurement" role="doc-biblioref">1977</a>)</span> (p.&nbsp;165). Thus, we could report that the effect size of the significant differences is ‘very small’.</p>
<div id="tbl-effect-size-kendalls-w" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-effect-size-kendalls-w-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.6: Interpretation benchmarks for the effect size Kendall’s W
</figcaption>
<div aria-describedby="tbl-effect-size-kendalls-w-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 47%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th>Kendall’s W</th>
<th>Interpretation <span class="citation" data-cites="landis1977measurement">(<a href="references.html#ref-landis1977measurement" role="doc-biblioref">Landis and Koch 1977</a>)</span></th>
<th>Alternative interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.00-0.02</td>
<td>Slight agreement</td>
<td>Very small</td>
</tr>
<tr class="even">
<td>0.21-0.40</td>
<td>Fair agreement</td>
<td>Small</td>
</tr>
<tr class="odd">
<td>0.41-0.60</td>
<td>Moderate agreement</td>
<td>Moderate</td>
</tr>
<tr class="even">
<td>0.61-0.80</td>
<td>Substantial agreement</td>
<td>Large</td>
</tr>
<tr class="odd">
<td>0.81-1.00</td>
<td>Almost perfect agreement</td>
<td>Very large</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
</section>
</section>
<section id="sec-chi-squared-test" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="sec-chi-squared-test"><span class="header-section-number">11.4</span> Comparing groups based on factors: Contingency tables</h2>
<p>So far, our dependent variable was always a numeric one. However, what if both independent and dependent variables are categorical? In such cases, we can only count the number of occurrences for each combination of the categories.</p>
<p>For example, we might recode our previous dependent variable <code>satisfaction</code> into a dichotomous one, i.e.&nbsp;participants are either happy or not. This is also known as a binary/logical variable (see <a href="07_data_wrangling.html#sec-change-data-types" class="quarto-xref"><span>Section 7.4</span></a>). Since the original scale ranges from 1-10, we assume that participants who scored higher than <code>5</code> are <code>satisfied</code> with their lives, while those who scored lower are categorised as <code>unsatisfied</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dichotomous/binary variable for satisfaction</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="ot">&lt;-</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">satisfaction_bin =</span> <span class="fu">as_factor</span>(<span class="fu">ifelse</span>(satisfaction <span class="sc">&gt;</span> <span class="dv">5</span>,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"satisfied"</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"unsatisfied"</span>))</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Your first intuition is likely to ask: Are there more <code>satisfied</code> or <code>unsatisfied</code> people in my sample?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="sc">|&gt;</span> <span class="fu">count</span>(satisfaction_bin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  satisfaction_bin     n
  &lt;fct&gt;            &lt;int&gt;
1 unsatisfied       3087
2 satisfied         5477</code></pre>
</div>
</div>
<p>The results reveal that considerably more people are <code>satisfied</code> with their life than there are <code>unsatisfied</code> people. In the spirit of group comparisons, we might wonder whether <code>gender</code> differences might exist among the <code>satisfied</code> and <code>unsatisfied</code> group of people. Thus, we want to split the <code>satisfied</code> and <code>unsatisfied</code> responses into <code>male</code> and <code>female</code> groups. We can do this by adding a second argument to the function <code>count()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="sc">|&gt;</span> <span class="fu">count</span>(satisfaction_bin, gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  satisfaction_bin gender     n
  &lt;fct&gt;            &lt;fct&gt;  &lt;int&gt;
1 unsatisfied      female  1554
2 unsatisfied      male    1533
3 satisfied        female  2794
4 satisfied        male    2683</code></pre>
</div>
</div>
<p>This <code>tibble</code> reveals that there are more <code>female</code> participants who are satisfied than <code>male</code> ones. However, the same is true for the category <code>unsatisfied</code>. Using absolute values is not very meaningful when the sample sizes of each group are not equal. Thus, it is better to use the relative frequency instead and adding it as a new variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(satisfaction_bin, gender) <span class="sc">|&gt;</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="fu">round</span>(n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">3</span>)) <span class="co"># compute the percentages</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>ct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   gender [2]
  satisfaction_bin gender     n  perc
  &lt;fct&gt;            &lt;fct&gt;  &lt;int&gt; &lt;dbl&gt;
1 unsatisfied      female  1554 0.357
2 unsatisfied      male    1533 0.364
3 satisfied        female  2794 0.643
4 satisfied        male    2683 0.636</code></pre>
</div>
</div>
<p>The relative frequency (<code>perc</code>) reveals that <code>female</code> and <code>male</code> participants are equally satisfied and unsatisfied. In other words, we could argue that gender does not explain satisfaction with life because the proportion of <code>male</code> and <code>female</code> participants is almost identical.</p>
<p>A more common and compact way to show such dependencies between categorical variables is a contingency table. To convert our current table into a contingency table, we need to map the levels of <code>satisfaction_bin</code> as rows (i.e.&nbsp;<code>satisfied</code> and <code>unsatisfied</code>), and for <code>gender</code>, we want each level represented as a column (i.e.&nbsp;<code>male</code> and <code>female</code>). This can be achieved with the function <code>pivot_wider()</code>. It turns our ‘long’ data frame into a ‘wide’ one. Therefore, we basically perform the opposite of what the function <code>pivot_longer()</code> did earlier. However, this means that our data is not ‘tidy’ anymore. Let’s take a look at the output first to understand better what we try to achieve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>ct <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> satisfaction_bin,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_from =</span> gender,</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_from =</span> perc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  satisfaction_bin female  male
  &lt;fct&gt;             &lt;dbl&gt; &lt;dbl&gt;
1 unsatisfied       0.357 0.364
2 satisfied         0.643 0.636</code></pre>
</div>
</div>
<p>The resulting <code>tibble</code> looks like a table as we know it from Excel. It is much more compact than the long format. However, what are the different arguments I passed to the function <code>pivot_wider()</code>? Here is a more detailed explanation of what we just did:</p>
<ul>
<li><p><code>id_cols</code> refers to one or more columns that define the groups for each row. In our case, we wanted to group observations based on whether these reflect the state of <code>satisfied</code> or <code>unsatisfied</code>. Thus, each group is only represented once in this column. The underlying concept is comparable to using the function <code>group_by()</code> together with <code>summarise()</code>, which happens to be the same as using <code>count()</code>.</p></li>
<li><p><code>names_from</code> defines which variable should be translated into separate columns. In other words, we replace the column <code>gender</code> and create a new column for each level of the factor, i.e.&nbsp;<code>male</code> and <code>female</code>.</p></li>
<li><p><code>values_from</code> requires us to specify which variable holds the values that should be entered into our table. Since we want our percentages included in the final output, we use <code>perc</code>.</p></li>
</ul>
<p>It is essential to note that we did not change any values but rearranged them. However, we lost one variable, i.e.&nbsp;<code>n</code>. Where has it gone? When using <code>pivot_wider()</code> we have to make sure we include all variables of interest. By default, the function will drop any other variables not mentioned. If we want to keep <code>n</code>, we can include it as another variable that is added to <code>values_from</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>ct <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> satisfaction_bin,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_from =</span> gender,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_from =</span> <span class="fu">c</span>(perc, n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  satisfaction_bin perc_female perc_male n_female n_male
  &lt;fct&gt;                  &lt;dbl&gt;     &lt;dbl&gt;    &lt;int&gt;  &lt;int&gt;
1 unsatisfied            0.357     0.364     1554   1533
2 satisfied              0.643     0.636     2794   2683</code></pre>
</div>
</div>
<p>The table has become even wider because we have two more columns to show the absolute frequency per <code>gender</code> and <code>satisfaction_bin</code>.</p>
<p>As you already know, there are situations where we want to turn a ‘wide’ data frame into a ‘long’ one. We performed such a step earlier and there is an in-depth example provided in <a href="13_regressions.html#sec-reviewing-the-outliers" class="quarto-xref"><span>Section 13.2.1.5</span></a>. Knowing how to pivot dataset is an essential data wrangling skill and something you should definitely practice to perfection.</p>
<p>Contingency tables are like plots: They provide an excellent overview of our data structure and relationships between variables. However, they provide no certainty about the strength of relationships. Therefore, we need to draw on a set of statistical tests to gain further insights.</p>
<p>Similar to previous group comparisons, we can distinguish between paired and unpaired groups. I will cover each comparison in turn and allude to plotting two or more categories in a <code>ggplot()</code>.</p>
<section id="sec-unpaired-groups-categorical-variables" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="sec-unpaired-groups-categorical-variables"><span class="header-section-number">11.4.1</span> Unpaired groups of categorical variables</h3>
<p>In the introduction to this chapter, we covered a classic example of an unpaired comparison of two groups (<code>male</code> and <code>female</code>) regarding another categorical variable, i.e.&nbsp;<code>satisfaction_bin</code>. The tables we produced offered detailed insights into the distribution of these categories. However, it is always helpful to have a visual representation. Plotting two categorical variables (i.e.&nbsp;factors) in <code>ggplot2</code> can be achieved in many different ways. Three commonly used options are shown in <a href="#fig-three-plots-satisfaction-gender" class="quarto-xref">Figure&nbsp;<span>11.1</span></a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with absolute frequencies (stacked)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>absolute_stacked <span class="ot">&lt;-</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> satisfaction_bin,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stacked absolute frequency"</span>) <span class="sc">+</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with absolute frequencies (grouped)</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>absolute_grouped <span class="ot">&lt;-</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> satisfaction_bin,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Grouped absolute frequency"</span>) <span class="sc">+</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with relative frequencies</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>relative <span class="ot">&lt;-</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> satisfaction_bin,</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Relative frequency"</span>) <span class="sc">+</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot all three plots with 'patchwork' package</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>absolute_stacked <span class="sc">+</span> absolute_grouped <span class="sc">+</span> relative <span class="sc">+</span> <span class="fu">plot_spacer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-three-plots-satisfaction-gender" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-three-plots-satisfaction-gender-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11_group_comparison_files/figure-html/fig-three-plots-satisfaction-gender-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-three-plots-satisfaction-gender-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.1: Three ways to plot frequencies.
</figcaption>
</figure>
</div>
</div>
</div>
<p>A more elegant and compact way of visualising frequencies across two or more categories are <em>mosaic plots</em>. These visualise relative frequencies for both variables in one plot. For example, consider the following mosaic plot created with the package <code>ggmosaic</code> and the function <code>geom_mosaic()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(satisfaction_bin, gender),</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_mosaic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `scale_name` argument of `continuous_scale()` is deprecated as of ggplot2
3.5.0.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `trans` argument of `continuous_scale()` is deprecated as of ggplot2 3.5.0.
ℹ Please use the `transform` argument instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `unite_()` was deprecated in tidyr 1.2.0.
ℹ Please use `unite()` instead.
ℹ The deprecated feature was likely used in the ggmosaic package.
  Please report the issue at &lt;https://github.com/haleyjeppson/ggmosaic&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-mosaic-plot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="11_group_comparison_files/figure-html/fig-mosaic-plot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.2: A mosaic plot which visualises the relationship of two categorical variables.
</figcaption>
</figure>
</div>
</div>
</div>
<p>It might not be evident from our data, but frequencies of each variable determine the bars’ height and width. In other words, the width of the bars (i.e.&nbsp;x-axis) is determined by the relative frequency of <code>female</code> and <code>male</code> participants in our sample. On the other hand, the height of each bar (i.e.&nbsp;the y-axis) is specified by the relative frequency of <code>satisfied</code> and <code>unsatisfied</code>. This results in a square block that is divided by the respective relative distributions. Let me share an example where it is more apparent what a mosaic plot aims to achieve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(married, gender),</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> married)) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_mosaic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/mosaic-plot-gender-married-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this example, we can tell that there were more <code>male</code> participants than females because the bar for <code>male</code> is much wider. Apart from that, we notice that <code>female</code> participants have more missing values <code>NA</code> for the variable <code>married</code>. However, more <code>female</code> participants reported that they are <code>married</code>, i.e.&nbsp;answered with <code>yes</code>. While mosaic plots make for impressive visualisations, we must be mindful that more complex visualisations are always more challenging to understand. Thus, it is wise to plan the usage of such plots carefully depending on your audience.</p>
<p>Throughout the remaining chapters, I will use the mosaic plot to illustrate distributions. The main difference to regular bar plots is the function <code>product()</code>, which allows us to define different variables of interest instead of using <code>x</code> and <code>y</code> in the <code>aes()</code> of <code>ggplot()</code>. It is this function that enables a mosaic visualisation. Apart from that, the same <code>ggplot2</code> syntax applies.</p>
<p>When it comes to the computational side of things, we have to distinguish whether our two variables create a 2-by-2 matrix, i.e.&nbsp;both variables only have two levels. Depending on which scenario applies to our analysis, a different statistical test has to be performed. For some tests, a minimum frequency for each value in our contingency table (i.e.&nbsp;cells) also needs to be achieved. This is usually a matter of sample size and diversity in a sample. <a href="#tbl-statistical-tests-unpaired-cat-variables" class="quarto-xref">Table&nbsp;<span>11.7</span></a> provides an overview of the different scenarios and indicates the functions we have to use to conduct our analysis in <em>R</em>.</p>
<div id="tbl-statistical-tests-unpaired-cat-variables" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-statistical-tests-unpaired-cat-variables-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.7: Statistical tests to compare two unpaired categorical variables. Effect sizes are computed using the <code>effectsize</code> package.
</figcaption>
<div aria-describedby="tbl-statistical-tests-unpaired-cat-variables-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 30%">
<col style="width: 36%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>Matrix</th>
<th>Condition</th>
<th>Test</th>
<th>Function in R</th>
<th>Effect size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2x2</td>
<td>&lt; 10 obs.</td>
<td>Fisher’s Exact Test</td>
<td><code>fisher.test()</code></td>
<td><code>phi()</code></td>
</tr>
<tr class="even">
<td>2x2</td>
<td>&gt; 10 obs.</td>
<td>Chi-squared Test with Yate’s Continuity Correction</td>
<td><code>infer::chisq_test(correct = TRUE)</code><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></td>
<td><code>phi()</code></td>
</tr>
<tr class="odd">
<td>n x n</td>
<td>&gt; 5 obs. (80% of cells)</td>
<td>Chi-squared Test</td>
<td><code>infer::chisq_test()</code></td>
<td><code>cramers_v()</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>To cut a long story short, we only need to be worried about 2x2 contingency tables where the values in some (or all) cells are lower than 10. In those cases, we need to rely on the <em>Fisher’s Exact Test</em>. In all other cases, we can depend on the <em>Pearson Chi-squared Test</em> to do our bidding. The function <code>infer::chisq_test()</code> is based on the function <code>chisq.test()</code>, which automatically applies the required <em>Yate’s Continuity Correction</em> if necessary.</p>
<p>For every test that involves two categorical variables, we have to perform three steps:</p>
<ol type="1">
<li><p>Compute a contingency table and check the conditions outlined in <a href="#tbl-statistical-tests-unpaired-cat-variables" class="quarto-xref">Table&nbsp;<span>11.7</span></a>.</p></li>
<li><p>Conduct the appropriate statistical test.</p></li>
<li><p>If the test is significant, compute the effect size and interpret its value.</p></li>
</ol>
<p>Considering our example from the beginning of the chapter, we are confronted with a 2x2 table that has the following distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>ct <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> satisfaction_bin,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_from =</span> gender,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_from =</span> n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  satisfaction_bin female  male
  &lt;fct&gt;             &lt;int&gt; &lt;int&gt;
1 unsatisfied        1554  1533
2 satisfied          2794  2683</code></pre>
</div>
</div>
<p>We easily satisfy the requirement for a regular Chi-squared test with Yate’s Continuity Correction because each row has at least a value of 10. However, for demonstration purposes, I will show how to compute both the Chi-squared test and the Fisher’s Exact test for the same contingency table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fisher's Exact Test</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(wvs_nona<span class="sc">$</span>satisfaction_bin, wvs_nona<span class="sc">$</span>gender) <span class="sc">|&gt;</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Make output more readable</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1
Columns: 6
$ estimate    &lt;dbl&gt; 0.9734203
$ p.value     &lt;dbl&gt; 0.5584163
$ conf.low    &lt;dbl&gt; 0.8903427
$ conf.high   &lt;dbl&gt; 1.064261
$ method      &lt;chr&gt; "Fisher's Exact Test for Count Data"
$ alternative &lt;chr&gt; "two.sided"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Effect size</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>(phi <span class="ot">&lt;-</span> effectsize<span class="sc">::</span><span class="fu">phi</span>(wvs_nona<span class="sc">$</span>satisfaction_bin, wvs_nona<span class="sc">$</span>gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Phi (adj.) |       95% CI
-------------------------
0.00       | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_r</span>(phi<span class="sc">$</span>phi, <span class="at">rules =</span> <span class="st">"cohen1988"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "very small"
(Rules: cohen1988)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-squared test with Yate's continuity correction</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="sc">|&gt;</span> infer<span class="sc">::</span><span class="fu">chisq_test</span>(satisfaction_bin <span class="sc">~</span> gender,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">correct =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  statistic chisq_df p_value
      &lt;dbl&gt;    &lt;int&gt;   &lt;dbl&gt;
1     0.332        1   0.565</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Effect size</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>(cv <span class="ot">&lt;-</span> effectsize<span class="sc">::</span><span class="fu">cramers_v</span>(wvs_nona<span class="sc">$</span>satisfaction_bin, wvs_nona<span class="sc">$</span>gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V (adj.) |       95% CI
--------------------------------
0.00              | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_r</span>(cv<span class="sc">$</span>Cramers_v, <span class="at">rules =</span> <span class="st">"cohen1988"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "very small"
(Rules: cohen1988)</code></pre>
</div>
</div>
<p>Both tests reveal that the relationship between our variables is not significant (<span class="math inline">\(p &gt; 0.05\)</span>), and the effect sizes are very small. This result aligns with our visualisation shown in <a href="#fig-mosaic-plot" class="quarto-xref">Figure&nbsp;<span>11.2</span></a> because everything looks very symmetrical.</p>
<p>Contingency tables do not always come as 2x2 matrices. Therefore, it makes sense to look at one more example where we have a much larger matrix. Bear in mind that the larger your matrix, the larger your dataset has to be to produce reliable results.</p>
<p>Let’s explore an example for a contingency table that is a 6x2 matrix. Imagine yourself at a soirée<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>, and someone might raise the question: Is it true that men are less likely to be married than women? To give you an edge over others at this French evening party, we can take a closer look at this matter with our <code>wvs_nona</code> dataset. We can create a mosaic plot and contingency table which feature <code>relationship_status</code> and <code>gender</code>.</p>
<p>As usual, let’s start with a plot first. We create a mosaic plot to visualise all six levels of the factor <code>relationship_status</code> against the two levels of <code>gender</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(relationship_status, gender),</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> relationship_status)) <span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_mosaic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/contigency-tbl-plot-relationship-status-gender-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While this plot is a lot more colourful than our previous ones, it still suggests that differences across categories are not particularly large. Especially the category <code>married</code> seems to indicate that <code>male</code> and <code>female</code> participants do not differ by much, i.e.&nbsp;their relative frequency is very similar. The only more considerable difference can be found for <code>widowed</code> and <code>single</code>. Apparently, <code>female</code> participants more frequently indicated being <code>widowed</code> while more <code>male</code> participants indicated that they are <code>single</code>.</p>
<p>Next, we compute the numbers underpinning this plot, comparing the absolute distribution to check our conditions and the relative distribution to interpret the contingency table correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check whether we fulfill the criteria</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>rel_gen <span class="ot">&lt;-</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  wvs_nona <span class="sc">|&gt;</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(relationship_status, gender)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>rel_gen</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   relationship_status        gender     n
   &lt;fct&gt;                      &lt;fct&gt;  &lt;int&gt;
 1 married                    female  2688
 2 married                    male    2622
 3 living together as married female   242
 4 living together as married male     202
 5 separated                  female    87
 6 separated                  male      55
 7 widowed                    female   339
 8 widowed                    male      74
 9 single                     female   858
10 single                     male    1188
11 divorced                   female   134
12 divorced                   male      75</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute relative frequency</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>rel_gen <span class="sc">|&gt;</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">|&gt;</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">perc =</span> <span class="fu">round</span>(n <span class="sc">/</span> <span class="fu">sum</span>(n), <span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> relationship_status,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> gender,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> perc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  relationship_status        female  male
  &lt;fct&gt;                       &lt;dbl&gt; &lt;dbl&gt;
1 married                     0.618 0.622
2 living together as married  0.056 0.048
3 separated                   0.02  0.013
4 widowed                     0.078 0.018
5 single                      0.197 0.282
6 divorced                    0.031 0.018</code></pre>
</div>
</div>
<p>The contingency table with the relative frequencies confirms what we suspected. The differences are very minimal between <code>male</code> and <code>female</code> participants. In a final step, we need to perform a Chi-squared test to see whether the differences are significant or not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Chi-squared test</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>wvs_nona <span class="sc">|&gt;</span> infer<span class="sc">::</span><span class="fu">chisq_test</span>(relationship_status <span class="sc">~</span> gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  statistic chisq_df  p_value
      &lt;dbl&gt;    &lt;int&gt;    &lt;dbl&gt;
1      250.        5 6.77e-52</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute effect size</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>(cv <span class="ot">&lt;-</span> effectsize<span class="sc">::</span><span class="fu">cramers_v</span>(wvs_nona<span class="sc">$</span>relationship_status,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>                            wvs_nona<span class="sc">$</span>gender))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V (adj.) |       95% CI
--------------------------------
0.17              | [0.15, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_r</span>(cv<span class="sc">$</span>Cramers_v, <span class="at">rules =</span> <span class="st">"cohen1988"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "small"
(Rules: cohen1988)</code></pre>
</div>
</div>
<p>The statistical results further confirm that the relationship between <code>relationship_status</code> and <code>gender</code> is weak but significant. Therefore, at your next soirée, you can confidently say: “This is bogus. The World Value Survey, which covers 48 different countries, shows that such a relationship is weak considering responses from over 69,000 individuals.” #cheers-to-that</p>
</section>
<section id="sec-paired-groups-categorical-variables" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="sec-paired-groups-categorical-variables"><span class="header-section-number">11.4.2</span> Paired groups of categorical variables</h3>
<p>Similar to paired group comparisons, contingency tables may show paired data. For example, we could be interested in knowing whether an intercultural training we delivered improved participants skills (or at least their personal perception of having improved).</p>
<p>The dataset <code>ic_training</code> looks at participants’ confidence in <code>communication</code> with people from diverse cultural backgrounds before and after an intercultural training session. Thus, we might be curious to know whether the training was effective. The dataset contains multiple versions of the same variable measured in different ways. Let’s begin with the variable <code>communication2</code>, which measures improvement as a factor with only two levels, i.e.&nbsp;<code>yes</code> and <code>no</code>. We can start by plotting a mosaic plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>ic_training <span class="sc">|&gt;</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(test, communication2),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> test)) <span class="sc">+</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_mosaic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/mosaic-plot-test-communication-two-by-two-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The mosaic plot shows that more participants indicate to be more confident in communicating with culturally others <code>post-training</code>. There were only very few participants who indicated that they have not become more confident.</p>
<p>In the next step, we want to compute the contingency table. However, there is one aspect we need to account for: The responses are paired, and therefore we need a contingency table of paired responses. This requires some modification of our data. Let’s start with a classic contingency table as we did for unpaired data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unpaired contingency table</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>ic_training <span class="sc">|&gt;</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(test, communication2) <span class="sc">|&gt;</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(test) <span class="sc">|&gt;</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> test,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> communication2,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n) <span class="sc">|&gt;</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.double), round, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
# Groups:   test [2]
  test            yes    no
  &lt;fct&gt;         &lt;int&gt; &lt;int&gt;
1 pre_training     18    30
2 post_training    47     1</code></pre>
</div>
</div>
<p>This contingency table reflects the mosaic plot we created, but it does not show paired answers. If we sum the frequencies in each cell, we receive a score of <code>96</code>, which equals the number of observations in <code>ic_training</code>. However, since we have two observations per person (i.e.&nbsp;paired responses), we only have 48 participants. Thus, this frequency table treats the pre and post-training group as independent from each other, which is obviously incorrect.</p>
<p>The current dataset includes two rows for each participant. Therefore, if we want to create a contingency table with paired scores, we first need to convert our data so that each participant is reflected by one row only, i.e.&nbsp;we need to make our data frame wider with <code>pivot_wider()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating data frame reflecting paired responses</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>paired_data <span class="ot">&lt;-</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  ic_training <span class="sc">|&gt;</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> name,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> test,</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> communication2)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>paired_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 3
   name                       pre_training post_training
   &lt;chr&gt;                      &lt;fct&gt;        &lt;fct&gt;        
 1 Hamlin, Christiana         no           no           
 2 Horblit, Timothy           no           yes          
 3 Grady, Justin              no           yes          
 4 Grossetete-Alfaro, Giovana no           yes          
 5 Dingae, Lori               no           yes          
 6 el-Sabir, Saamyya          no           yes          
 7 Reynolds, Tylor            no           yes          
 8 Aslami, Andrew             no           yes          
 9 Alexander, Kiri            no           yes          
10 Guzman Pineda, Timothy     no           yes          
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>In simple terms, we converted the column <code>communication2</code> into two columns based on the factor levels of <code>test</code>, i.e.&nbsp;<code>pre-training</code> and <code>post-training</code>. If we now use these two columns to create a contingency table and mosaic plot, we understand of how the paired distributions between <code>pre-training</code> and <code>post-training</code> look like.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contignency table with paired values</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>ct_paired <span class="ot">&lt;-</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  paired_data <span class="sc">|&gt;</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(pre_training, post_training) <span class="sc">|&gt;</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> post_training,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">"post_training_"</span>,</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> n,</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="co"># fill empty cells with '0'</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>ct_paired</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  pre_training post_training_yes post_training_no
  &lt;fct&gt;                    &lt;int&gt;            &lt;int&gt;
1 yes                         18                0
2 no                          29                1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contigency table with paired percentage values</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>ct_paired <span class="sc">|&gt;</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">post_training_yes =</span> post_training_yes <span class="sc">/</span> <span class="fu">nrow</span>(paired_data),</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">post_training_no =</span> post_training_no <span class="sc">/</span> <span class="fu">nrow</span>(paired_data)) <span class="sc">|&gt;</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.double), round, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  pre_training post_training_yes post_training_no
  &lt;fct&gt;                    &lt;dbl&gt;            &lt;dbl&gt;
1 yes                       0.38             0   
2 no                        0.6              0.02</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mosaic plot with paired values</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>paired_data <span class="sc">|&gt;</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(pre_training, post_training),</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> post_training)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_mosaic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/mosaic-plot-paired-pre-post-training-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With these insights, we can refine our interpretation and state the following:</p>
<ul>
<li><p>There were 19 participants (40%) for whom the training caused no change, i.e.&nbsp;before and after the training their response was still <code>yes</code> or <code>no</code>.</p></li>
<li><p>However, for the other 29 participants (60%), the training helped them change from <code>no</code> to <code>yes</code>. This is an excellent result.</p></li>
<li><p>We notice that no participant scored <code>no</code> after the training was delivered, which is also a great achievement.</p></li>
</ul>
<p>Lastly, we need to perform a statistical test to confirm our suspicion that the training significantly impacted participants. For paired 2x2 contingency tables, we have to use <em>McNemar’s Test</em>, using the function <code>mcnemar.test()</code>. To determine the effect size, we have to compute <em>Cohen’s g</em> and use the function <code>cohens_g()</code> from the <code>effectsize</code> package to compute it. Be aware that we have to use the <code>paired_data</code> as our data frame and not <code>ic_training</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#McNemar's test</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcnemar.test</span>(paired_data<span class="sc">$</span>pre_training, paired_data<span class="sc">$</span>post_training)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    McNemar's Chi-squared test with continuity correction

data:  paired_data$pre_training and paired_data$post_training
McNemar's chi-squared = 27.034, df = 1, p-value = 1.999e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">cohens_g</span>(paired_data<span class="sc">$</span>pre_training, paired_data<span class="sc">$</span>post_training)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's g |       95% CI
------------------------
0.50      | [0.38, 0.50]</code></pre>
</div>
</div>
<p>To correctly interpret the effect size <span class="citation" data-cites="cohen1988statistical">Cohen (<a href="references.html#ref-cohen1988statistical" role="doc-biblioref">1988</a>)</span> suggest the following benchmarks:</p>
<ul>
<li><p><span class="math inline">\(g &lt; 0.05 = negligible\)</span>,</p></li>
<li><p><span class="math inline">\(0.05 \leq g &lt; 0.15 = small\)</span>,</p></li>
<li><p><span class="math inline">\(0.15 \leq g &lt; 0.25 = medium\)</span>,</p></li>
<li><p><span class="math inline">\(0.25 \leq g = large\)</span>.</p></li>
</ul>
<p>Thus, our effect size is very large, and we can genuinely claim that the intercultural training had a significant impact on the participants. Well, there is only one flaw in our analysis. An eager eye will have noticed that one of our cells was empty, i.e.&nbsp;the top-right cell in the contingency table. The conditions to run such a test are similar to the Chi-squared test. Thus, using the McNemar test is not entirely appropriate in our case. Instead, we need to use the <em>‘exact McNemar test’</em>, which compares the results against a binomial distribution and not a chi-squared one. More important than remembering the name or the distribution is to understand that the exact test produces more accurate results for smaller samples. However, we have to draw on a different package to compute it, i.e.&nbsp;<code>exact2x2</code> and its function <code>mcnemar.exact()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcnemar.exact</span>(paired_data<span class="sc">$</span>pre_training, paired_data<span class="sc">$</span>post_training)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact McNemar test (with central confidence intervals)

data:  paired_data$pre_training and paired_data$post_training
b = 0, c = 29, p-value = 3.725e-09
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 0.0000000 0.1356472
sample estimates:
odds ratio 
         0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">"package:exact2x2"</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Even after using a more robust computation for our data, the results are still significant. Thus, there is no doubt that the intercultural training helped participants to improve.</p>
<p>There are many other combinations of contingency tables. For example, the McNemar test can be extended to a 3x3 or higher matrix, but the rows and columns must be the same length. If you want to compare multiple categorical variables which do not follow a square matrix, it would be necessary to look into a loglinear analysis. While this book does not cover this technique, an excellent starting point is provided by <span class="citation" data-cites="field2013discovering">Field (<a href="references.html#ref-field2013discovering" role="doc-biblioref">2013</a>)</span> (p.&nbsp;732ff).</p>
</section>
<section id="sec-a-final-remark-about-comparing-groups-based-on-categorical-data" class="level3" data-number="11.4.3">
<h3 data-number="11.4.3" class="anchored" data-anchor-id="sec-a-final-remark-about-comparing-groups-based-on-categorical-data"><span class="header-section-number">11.4.3</span> A final remark about comparing groups based on categorical data</h3>
<p>Admittedly, I hardly ever find studies in the field of Social Sciences which work with primarily categorical data. Political Science might be an exception because working, for example, with polling data often implies working with categorical data. A reason you likely will not find yourself in the situation to work with such data and analytical techniques is measurement accuracy. If you look at the dataset <code>ic_training</code>, the variable <code>communication2</code> was artificially created to turn <code>numeric</code> data into a <code>factor</code>. This is usually not good practice because you lose measurement accuracy, and it can exaggerate differences between groups. Consider the following plots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  ic_training <span class="sc">|&gt;</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> communication)) <span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Full scale"</span>)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  ic_training <span class="sc">|&gt;</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> communication3)) <span class="sc">+</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Category with 3 levels"</span>)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  ic_training <span class="sc">|&gt;</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> communication2)) <span class="sc">+</span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Category with 2 levels"</span>)</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine plots into one single plot with 'patchwork' package</span></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_spacer</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="11_group_comparison_files/figure-html/comparing-categorical-vs-numerical-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The more we aggregate the data into fewer categories, the more likely we increase differences between groups. For example, the plot <code>Category with 3 levels</code> shows that most participants fall into the category <code>medium</code>. However, reducing the categories to two, some participants are classified as <code>yes</code> and some as <code>no</code>. Thus, some respondents who were classified as <code>medium</code> are now in the <code>no</code> category. In reality, we know from our non-categorical measures that several participants will still have improved in confidence but are considered with those who have not improved. This is a major problem because it seems more people are not confident about communicating with people from different cultural backgrounds than there actually are. The accuracy of our measurement scale is poor.</p>
<p>In short, I recommend to only use the techniques outlined in this chapter if your data is truly categorical in nature. Thus, when designing your data collection tool, you might also wish to abstain from measuring quantitative variables as categories, for example <code>age</code>, which is a very popular choice among my students. While it might be sometimes more appropriate to offer categories, it is always good to use multiple categories and not just two or three. Every additional level in your factor will increase measurement accuracy and provides access to more advanced analytical techniques. Remember, it is always possible to convert <code>numeric</code> data into a <code>factor</code>, but not the other way around.</p>
</section>
</section>
<section id="sec-reviewing-group-comparisons" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="sec-reviewing-group-comparisons"><span class="header-section-number">11.5</span> Reviewing group comparisons</h2>
<p>In Social Sciences, we often compare individuals against each other or with themselves over time. As such, understanding how to compare groups of participants is an essential analytical skill. The techniques outlined in this chapter merely provide a solid starting point and likely cover about 90% of the datasets you will encounter or collect. For the other 10% of cases, you might have to look further for more niche approaches to comparing groups. There is also more to know about these techniques from a theoretical and conceptual angle. However, as far as the computation in <em>R</em> is concerned, you should be able to tackle your research projects confidently.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-altman1985comparability" class="csl-entry" role="listitem">
Altman, Douglas G. 1985. <span>“Comparability of Randomised Groups.”</span> <em>Journal of the Royal Statistical Society: Series D (The Statistician)</em> 34 (1): 125–36.
</div>
<div id="ref-berger2006review" class="csl-entry" role="listitem">
Berger, Vance W. 2006. <span>“A Review of Methods for Ensuring the Comparability of Comparison Groups in Randomized Clinical Trials.”</span> <em>Reviews on Recent Clinical Trials</em> 1 (1): 81–86.
</div>
<div id="ref-blanca2017non" class="csl-entry" role="listitem">
Blanca Mena, M José, Rafael Alarcón Postigo, Jaume Arnau Gras, Roser Bono Cabré, and Rebecca Bendayan. 2017. <span>“Non-Normal Data: Is ANOVA Still a Valid Option?”</span> <em>Psicothema, 2017, Vol. 29, Num. 4, p. 552-557</em>.
</div>
<div id="ref-cohen1988statistical" class="csl-entry" role="listitem">
Cohen, Jacob. 1988. <em>Statistical Power Analysis for the Behavioral Sciences New York</em>. <em>NY: Academic Press</em>.
</div>
<div id="ref-dinno2015nonparametric" class="csl-entry" role="listitem">
Dinno, Alexis. 2015. <span>“Nonparametric Pairwise Multiple Comparisons in Independent Groups Using Dunn’s Test.”</span> <em>The Stata Journal</em> 15 (1): 292–300.
</div>
<div id="ref-field2013discovering" class="csl-entry" role="listitem">
Field, Andy. 2013. <em>Discovering Statistics Using IBM SPSS Statistics</em>. Sage Publications.
</div>
<div id="ref-greenhouse1959methods" class="csl-entry" role="listitem">
Greenhouse, Samuel W, and Seymour Geisser. 1959. <span>“On Methods in the Analysis of Profile Data.”</span> <em>Psychometrika</em> 24 (2): 95–112.
</div>
<div id="ref-hochberg1974some" class="csl-entry" role="listitem">
Hochberg, Yosef. 1974. <span>“Some Generalizations of the t-Method in Simultaneous Inference.”</span> <em>Journal of Multivariate Analysis</em> 4 (2): 224–34.
</div>
<div id="ref-hochberg1988sharper" class="csl-entry" role="listitem">
———. 1988. <span>“A Sharper Bonferroni Procedure for Multiple Tests of Significance.”</span> <em>Biometrika</em> 75 (4): 800–802.
</div>
<div id="ref-huynh1976estimation" class="csl-entry" role="listitem">
Huynh, Huynh, and Leonard S Feldt. 1976. <span>“Estimation of the Box Correction for Degrees of Freedom from Sample Data in Randomized Block and Split-Plot Designs.”</span> <em>Journal of Educational Statistics</em> 1 (1): 69–82.
</div>
<div id="ref-landis1977measurement" class="csl-entry" role="listitem">
Landis, J Richard, and Gary G Koch. 1977. <span>“The Measurement of Observer Agreement for Categorical Data.”</span> <em>Biometrics</em>, 159–74.
</div>
<div id="ref-tomarken1986comparison" class="csl-entry" role="listitem">
Tomarken, Andrew J, and Ronald C Serlin. 1986. <span>“Comparison of ANOVA Alternatives Under Variance Heterogeneity and Specific Noncentrality Structures.”</span> <em>Psychological Bulletin</em> 99 (1): 90.
</div>
<div id="ref-yang2006-IBmethods" class="csl-entry" role="listitem">
Yang, Zhilin, Xuehua Wang, and Chenting Su. 2006. <span>“A Review of Research Methodologies in International Business.”</span> <em>International Business Review</em> 15 (6): 601–17. https://doi.org/<a href="https://doi.org/10.1016/j.ibusrev.2006.08.003">https://doi.org/10.1016/j.ibusrev.2006.08.003</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>These functions are taken from the <code>effectsize</code> package.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>In order to use this package, it is necessary to install a series of other packages found on <a href="https://www.bioconductor.org" target="blank" title="bioconductor.org">bioconductor.org</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><code>infer</code> is an R package which is part of <code>tidymodels</code>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>A fancy way of saying ‘evening party’ in French.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./10_correlations.html" class="pagination-link  aria-label=" &lt;span="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Correlations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12_power_analysis.html" class="pagination-link" aria-label="<span class='chapter-number'>12</span>&nbsp; <span class='chapter-title'>Power: You either have it or you don't</span>">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Power: You either have it or you don’t</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ddauber/r4np-quarto-crc/blob/main/11_group_comparison.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/ddauber/r4np-quarto-crc/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>